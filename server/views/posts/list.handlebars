{{!-- <div class="container">
    <div class="row mb-3">
        <div class="col">
            <h1>Posts</h1>
            <div>Page: {{page}} / {{totalPages}} </div>
            <button class="btn-primary btn">
                <a href="/posts/submit" class="text-white">Create post</a>
            </button>
        </div>
    </div>
    <div class="row row-cols-1 g-3">
        {{#each posts}}
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">
                        {{this.title}}
                    </h5>
                    <p class="card-text">
                        {{this.body}}
                    </p>
                    <div><small>{{this.createdAt}} | {{this.authorUsername}}</small></div>
                </div>
            </div>
        </div>
        {{/each}}
    </div>

    <div class="row">
        {{#if prevPage}}
        <div class="col">
            <button class="btn btn-primary">
                <a href="/posts/list/{{prevPage}}" class="text-white">
                    Previous Page
                </a>
            </button>
        </div>
        {{/if}}
        {{#if nextPage}}
        <div class="col">
            <button class="btn btn-primary">
                <a href="/posts/list/{{nextPage}}" class="text-white">
                    Next Page
                </a>
            </button>
        </div>
        {{/if}}
    </div>

</div> --}}
{{!-- <form action="/posts/submit" method="POST">
    <input type="text" id="t" name="">
    <input type="text" id="b" name="b">
    <button type="submit">click here</button>
</form> --}}

{{!-- <nav class="navbar bg-body-tertiary">

    <div class="container-fluid">
        <a class="navbar-brand" href="#">Navbar</a>
        <a class="navbar-brand" href="#">Navbar</a>
    </div>

</nav> --}}
<div class="container" style="max-width:100%;margin-top:10px;">
    <div class="row">
        <div class="col-3" style="margin:10px;margin-top:100px;">
            <p>Hot</p>
            <p>New</p>
            <p>Trending</p>
            <p class="mb-5">Favourites</p>
            <div class="mb-5">
                <b>Top Contributors<br></b>
                <h3><i class="bi bi-person-circle"></i> <i class="bi bi-person-circle"></i> <i
                        class="bi bi-person-circle"></i></h3>
            </div>
            <p class="mb-2">Activity</p>
            <div class="card" style="width: 18rem;border:none;">
                <div class="card-body">
                    <h6 class="card-title">Sleep is important</h6>

                    <a href="#" class="card-link" style="font-size: 1rem;text-decoration: none;color:grey;">
                        1200 points</a>
                    <a href="#" class="card-link" style="font-size: 1rem;"> <i class="bi bi-chat"
                            style="padding-right: 3px;"></i>135 comments </a>
                </div>
            </div>
            <hr style="color:grey;width: 60%;">
            <div class="card" style="width: 18rem;border:none;">
                <div class="card-body">
                    <h6 class="card-title">The end of addiction</h6>

                    <a href="#" class="card-link" style="font-size: 1rem;text-decoration: none;color:grey;">
                        1300 points</a>
                    <a href="#" class="card-link" style="font-size: 1rem;"> <i class="bi bi-chat"
                            style="padding-right: 3px;"></i>65 comments </a>
                </div>
            </div>
            <hr style="color:grey;width: 60%;">
            <div class="card" style="width: 18rem;border:none;">
                <div class="card-body">
                    <h6 class="card-title">Relapse is a sign</h6>

                    <a href="#" class="card-link" style="font-size: 1rem;text-decoration: none;color:grey;">
                        1004 points</a>
                    <a href="#" class="card-link" style="font-size: 1rem;"> <i class="bi bi-chat"
                            style="padding-right: 3px;"></i>45 comments </a>
                </div>
            </div>
            <hr style="color:grey;width: 60%;">
        </div>
        <div class="col-7">
            <div class="card" style="margin:0px;border:none;">
                <div class="card-body">

                    <div class="row">
                        <div class="col-4">
                            <h3>Popular </h3>
                        </div>
                        <div class="col-8">
                            {{!-- <div class="btn-group" style="position:absolute; right:100px;margin-top:6px;">
                                <button class="btn btn-secondary btn-sm dropdown-toggle" type="button"
                                    data-bs-toggle="dropdown" aria-expanded="false">
                                    Filter
                                </button>
                                <ul class="dropdown-menu" style="padding: 10px;width:100px;">
                                    <li>Highest votes</li>
                                    <li>Most Likes</li>
                                    <li>Top Comments</li>
                                </ul>
                            </div> --}}
                            <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                                data-bs-target="#staticBackdrop" style="position:absolute; right:0px;">
                                New Post
                            </button>

                            <!-- Modal -->
                            <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static"
                                data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel"
                                aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h1 class="modal-title fs-5" id="staticBackdropLabel">New Post</h1>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            <ul class="nav nav-underline" id="myTab" role="tablist">
                                                <li class="nav-item" role="presentation">
                                                    <button class="nav-link active" id="home-tab" data-bs-toggle="tab"
                                                        data-bs-target="#home-tab-pane" type="button" role="tab"
                                                        aria-controls="home-tab-pane" aria-selected="true">Post</button>

                                                </li>
                                                <li class="nav-item" role="presentation" aria-disabled="true">
                                                    <button class="nav-link" id="profile-tab" data-bs-toggle="tab"
                                                        data-bs-target="#profile-tab-pane" type="button" role="tab"
                                                        aria-controls="profile-tab-pane" aria-selected="false"
                                                        disabled>Images</button>
                                                </li>
                                                <li class="nav-item" role="presentation" aria-disabled="true">
                                                    <button class="nav-link" id="contact-tab" data-bs-toggle="tab"
                                                        data-bs-target="#contact-tab-pane" type="button" role="tab"
                                                        aria-controls="contact-tab-pane" aria-selected="false"
                                                        disabled>Links</button>
                                                </li>

                                            </ul>
                                            <br>
                                            <div class="tab-content">
                                                <div class="tab-pane active" id="home" role="tabpanel"
                                                    aria-labelledby="home-tab">
                                                    <form action="/posts/submit" method="post">
                                                        <div class="mb-3">
                                                            <label for="title" class="form-label">Title</label>
                                                            <input type="text" class="form-control" name="title"
                                                                placeholder="Post title (e.g. How I used time as an advantage)."
                                                                required>
                                                        </div>
                                                        <div class="mb-3">
                                                            <label for="body" class="form-label">Body</label>
                                                            <textarea type="email" class="form-control" name="body"
                                                                placeholder="The nitty gritty details..." rows="3"
                                                                required></textarea>
                                                        </div>
                                                        <button class="btn btn-primary">Submit</button>
                                                    </form>
                                                </div>
                                                <div class="tab-pane" id="profile" role="tabpanel"
                                                    aria-labelledby="profile-tab">...</div>
                                                <div class="tab-pane" id="messages" role="tabpanel"
                                                    aria-labelledby="messages-tab">...</div>

                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            {{!-- <button class="btn-primary btn" style="position:absolute;right:0px;">
                                <a href="/posts/submit" class="text-white" style="text-decoration: none;">Create
                                    post</a>
                            </button> --}}
                        </div>

                    </div>
                </div>
                {{!-- ALL POSTS --}}
                <div class="all-cards" style="margin-left:10px;">
                    {{#if posts}}
                    {{#each posts}}

                    <div class="card mb-2">
                        <div class="row">

                            <div class="col-8">

                                <div class="card-body" style="transform: rotate(0);">
                                    <a href="http://localhost:3000/posts/anon/post-2323423" class="stretched-link"
                                        style="text-decoration: none;"></a>
                                    <h5 class="card-title text-dark"><i class="bi bi-person-circle"></i>
                                        {{this.authorUsername}}</h5>
                                    <h6 class="card-subtitle mb-2 text-body-secondary">posted on
                                        {{this.createdAt}}</h6>
                                    <b class="card-text text-dark">{{this.title}}</b>
                                    <p class="card-text" style="color: #adadac;">{{this.body}}</p>

                                </div>
                                <div class="card-body">
                                    <a href="#" class="card-link "> <i class="bi bi-chat"
                                            style="padding-right: 3px;"></i> Comment</a>
                                    <a href="#" class="card-link"> <i class="bi bi-share"
                                            style="padding-right: 3px;"></i> Share</a>
                                    <a href="#" class="card-link"> <i class="bi bi-heart"
                                            style="padding-right: 3px;"></i> Like</a>
                                </div>
                            </div>

                            <div class="col-3" style="position: relative;text-align: right;padding: 10px;">
                                <div>
                                    <i class="bi bi-heart" style="padding-right: 3px;"></i><i
                                        class="bi bi-three-dots-vertical"></i>
                                </div>
                                <div class="mt-2">
                                    <img src="https://images.ctfassets.net/cnu0m8re1exe/4g8ng6Xo7Qau8aiV6nIGK/a8c1fbebff06904aa0ac44c1b5692ad0/Untitled_design__88_.png"
                                        style="height:120px;width:100%;object-fit: cover;" alt="Italian Trulli">
                                </div>

                            </div>

                            <div class="col-1"
                                style="display:flex;align-items:center;flex-direction:column;justify-content:center;">
                                {{!-- <form action="/posts/upvote" method="post"> --}}
                                    <div>

                                        <h3><button class="btn" onclick="up()"><i class="bi bi-caret-up"
                                                    id="up"></i></button></h3>

                                        <h3 hidden id="upcount">0</h3>

                                    </div>
                                    <div class="mb-2" id="votes" style="text-align: center;">
                                        15
                                        {{!-- <input type="number" hidden name="votes" value="{{this.votes}}">
                                        <input type="text" hidden name="id" value="{{this._id}}"> --}}
                                    </div>
                                    <div>
                                        <h3><button class="btn" onclick="down()"><i class="bi bi-caret-down "
                                                    id="down"></i></button></h3>
                                        <h3 hidden id="downcount">0</h3>
                                    </div>
                                    {{!--
                                </form> --}}
                            </div>

                        </div>
                    </div>

                    {{/each}}

                    <div>
                        <div class="row">

                            {{!-- {{#ifEquals page 2}} --}}
                            {{!-- <div class="col-2" style="text-align: right;">
                                <p hidden id="page">{{page}}</p>
                                <div class="" type="button" onclick="previouspage({{page}})" id="previous" hidden>
                                    <i class="bi bi-arrow-left-short"></i>Previous Page
                                </div>

                                <div class="" type="button" onclick="nextpage({{page}})">
                                    Next Page<i class="bi bi-arrow-right-short"></i>
                                </div>
                                {{!-- <a idhref="http://localhost:3000/posts/page/{{page}}">lmoa</a>

                            </div> --}}
                            <div class="row">


                                {{#if prevPage}}
                                <div class="col-4">
                                    <button class="btn btn-primary">
                                        <a href="/posts/list/{{prevPage}}" class="text-white"
                                            style="text-decoration: none;">
                                            Previous Page
                                        </a>
                                    </button>
                                </div>
                                {{else}}
                                <div class="col-4"></div>
                                {{/if}}
                                <div class="col-4" style="text-align: center;">
                                    <div>{{page}} / {{totalPages}} </div>
                                </div>
                                {{#if nextPage}}
                                <div class="col-4">
                                    <button class="btn btn-primary" style="position:absolute; right:0px;">
                                        <a href="/posts/list/{{nextPage}}" class="text-white"
                                            style="text-decoration: none;">
                                            Next Page
                                        </a>
                                    </button>
                                </div>
                                {{/if}}
                            </div>

                            {{!-- {{else}}
                            <div class="col-2" style="text-align: right;">
                                <div class="" type="button" onclick="nextpage({{page}})">
                                    Next Page<i class="bi bi-arrow-right-short"></i></h5>
                                </div>
                                {{!-- <a idhref="http://localhost:3000/posts/page/{{page}}">lmoa</a>

                            </div>
                            {{/ifEquals}} --}}

                        </div>

                    </div>
                    <br>
                    {{else}}
                    <div class="card">
                        <div class="card-body">
                            Page {{page}} does not exist
                        </div>
                    </div>
                    <div style="text-align:right;">Pages: N/A of {{totalPages}} pages </div>
                    <br>
                    {{/if}}

                </div>

            </div>

        </div>
    </div>

</div>

<script>
    window.addEventListener("load", (event) => {
        const previous = document.getElementById('previous');
        const page = document.getElementById("page").innerText
        if (parseInt(page) > 1) {
            previous.removeAttribute("hidden")
        } else {
            previous.setAttribute("hidden", "")
        }
        console.log("LOADED")
    });



    function up() {
        console.log("Test")

        var upcount = document.getElementById("upcount").innerText
        const value = document.getElementById("votes").innerText
        document.getElementById("votes").innerHTML = parseInt(value) + 1
        {
            {
                !--console.log(upcount)
                if (upcount === "0") {
                    const value = document.getElementById("votes").innerText
                    document.getElementById("votes").innerHTML = parseInt(value) + 1
                    document.getElementById("upcount").innerHTML = 1
                } else {
                    document.getElementById("downcount").innerHTML = 0

                } --}
        }

    }

    function down() {
        console.log("Test")

        var downcount = document.getElementById("downcount").innerText
        const value = document.getElementById("votes").innerText
        document.getElementById("votes").innerHTML = parseInt(value) - 1
        {
            {
                !-- if (parseInt(downcount) == 0) {
                    const value = document.getElementById("votes").innerText
                    document.getElementById("votes").innerHTML = parseInt(value) - 1
                    document.getElementById("downcount").innerHTML = 1
                } else {
                    document.getElementById("upcount").innerHTML = 0

                } --}
        }
    }
    function nextpage(page) {
        console.log(page)
        const newpage = parseInt(page) + 1
        window.location.href = `http://localhost:3000/posts/page/${newpage}`;
    }
    function previouspage(page) {
        const newpage = parseInt(page) - 1
        window.location.href = `http://localhost:3000/posts/page/${newpage}`;
    } 
</script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
    integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js"
    integrity="sha384-Rx+T1VzGupg4BHQYs2gCW9It+akI2MM/mndMCy36UVfodzcJcF0GGLxZIzObiEfa"
    crossorigin="anonymous"></script>